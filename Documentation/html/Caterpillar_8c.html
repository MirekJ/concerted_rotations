<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.11"/>
<title>Concerted Rotation: Code/lib/Caterpillar.c File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { init_search(); });
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">Concerted Rotation
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.11 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="modules.html"><span>Modules</span></a></li>
      <li><a href="annotated.html"><span>Data&#160;Structures</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="files.html"><span>File&#160;List</span></a></li>
      <li><a href="globals.html"><span>Globals</span></a></li>
    </ul>
  </div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_23fdee2f6995db16c755697cdf620cf4.html">Code</a></li><li class="navelem"><a class="el" href="dir_5d88b4709274d720d8b307b03f0b1a68.html">lib</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle">
<div class="title">Caterpillar.c File Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p>Interface for the Caterpillar protein model. Function's definitions.  
<a href="#details">More...</a></p>
<div class="textblock"><code>#include &quot;<a class="el" href="Caterpillar_8h_source.html">Caterpillar.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="messages_8h_source.html">./messages.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="my__geom_8h_source.html">./my_geom.h</a>&quot;</code><br />
<code>#include &lt;gsl/gsl_math.h&gt;</code><br />
<code>#include &lt;gsl/gsl_linalg.h&gt;</code><br />
<code>#include &quot;<a class="el" href="quaternions_8h_source.html">./quaternions.h</a>&quot;</code><br />
<code>#include &lt;stddef.h&gt;</code><br />
<code>#include &lt;stdlib.h&gt;</code><br />
<code>#include &lt;stdio.h&gt;</code><br />
</div><div class="textblock"><div class="dynheader">
Include dependency graph for Caterpillar.c:</div>
<div class="dyncontent">
<div class="center"><img src="Caterpillar_8c__incl.png" border="0" usemap="#Code_2lib_2Caterpillar_8c" alt=""/></div>
<map name="Code_2lib_2Caterpillar_8c" id="Code_2lib_2Caterpillar_8c">
<area shape="rect" id="node2" href="Caterpillar_8h.html" title="Interface for the Caterpillar protein model. " alt="" coords="17,80,109,107"/>
<area shape="rect" id="node4" href="messages_8h.html" title="Header file for function for typical STDERR Contain function for reading and writing PDB files..." alt="" coords="389,80,491,107"/>
<area shape="rect" id="node5" href="my__geom_8h.html" title="Source file for all functions for work vectors and geometric object. Adapted from the KymoKnot github..." alt="" coords="133,80,232,107"/>
<area shape="rect" id="node9" href="quaternions_8h.html" title="Header file for all functions for work with histogram structure Well not much else to say ..." alt="" coords="257,80,365,107"/>
</map>
</div>
</div><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:ae1b02845d422244db3c1cdfa38f3ee26"><td class="memItemLeft" align="right" valign="top"><a class="el" href="structcat__prot.html">cat_prot</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="Caterpillar_8c.html#ae1b02845d422244db3c1cdfa38f3ee26">CAT_prot_alloc</a> (size_t n_res, size_t n_atom_per_res)</td></tr>
<tr class="memdesc:ae1b02845d422244db3c1cdfa38f3ee26"><td class="mdescLeft">&#160;</td><td class="mdescRight">Allocates and initializes a <a class="el" href="structcat__prot.html" title="Main data structure for the caterpillar protein model. ">cat_prot</a> structure.  <a href="#ae1b02845d422244db3c1cdfa38f3ee26">More...</a><br /></td></tr>
<tr class="separator:ae1b02845d422244db3c1cdfa38f3ee26"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2b2c2c60d002feceda7f4b52d9b1c075"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="Caterpillar_8c.html#a2b2c2c60d002feceda7f4b52d9b1c075">CAT_prot_free</a> (<a class="el" href="structcat__prot.html">cat_prot</a> *p)</td></tr>
<tr class="memdesc:a2b2c2c60d002feceda7f4b52d9b1c075"><td class="mdescLeft">&#160;</td><td class="mdescRight">Deallocates a <a class="el" href="structcat__prot.html" title="Main data structure for the caterpillar protein model. ">cat_prot</a> structure.  <a href="#a2b2c2c60d002feceda7f4b52d9b1c075">More...</a><br /></td></tr>
<tr class="separator:a2b2c2c60d002feceda7f4b52d9b1c075"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:acba34c254cdc4419a15eb3913ab88fcc"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="Caterpillar_8c.html#acba34c254cdc4419a15eb3913ab88fcc">CAT_print</a> (<a class="el" href="structcat__prot.html">cat_prot</a> *protein)</td></tr>
<tr class="memdesc:acba34c254cdc4419a15eb3913ab88fcc"><td class="mdescLeft">&#160;</td><td class="mdescRight">Prints atom coordinates on stdout.  <a href="#acba34c254cdc4419a15eb3913ab88fcc">More...</a><br /></td></tr>
<tr class="separator:acba34c254cdc4419a15eb3913ab88fcc"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a92cf3cb6de5fafc75fa825ca64e1a571"><td class="memItemLeft" align="right" valign="top"><a class="el" href="structcat__prot.html">cat_prot</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="Caterpillar_8c.html#a92cf3cb6de5fafc75fa825ca64e1a571">CAT_build_from_dihed</a> (int n_res, size_t n_atom_per_res, double *orig, double *dihed, char *seq)</td></tr>
<tr class="memdesc:a92cf3cb6de5fafc75fa825ca64e1a571"><td class="mdescLeft">&#160;</td><td class="mdescRight">Constructs a protein configuration <a class="el" href="structcat__prot.html" title="Main data structure for the caterpillar protein model. ">cat_prot</a> from dihedral angles.  <a href="#a92cf3cb6de5fafc75fa825ca64e1a571">More...</a><br /></td></tr>
<tr class="separator:a92cf3cb6de5fafc75fa825ca64e1a571"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a51f603e9de1836964e2c5d042835b5a4"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="Caterpillar_8c.html#a51f603e9de1836964e2c5d042835b5a4">CAT_set_prot_linear</a> (<a class="el" href="structcat__prot.html">cat_prot</a> *protein, double orig[3], double alpha)</td></tr>
<tr class="separator:a51f603e9de1836964e2c5d042835b5a4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9810f8767994c951a2faf44bb016eeea"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="Caterpillar_8c.html#a9810f8767994c951a2faf44bb016eeea">CAT_set_residues_fasta</a> (<a class="el" href="structcat__prot.html">cat_prot</a> *protein, int Seq_Length, char *Enc)</td></tr>
<tr class="memdesc:a9810f8767994c951a2faf44bb016eeea"><td class="mdescLeft">&#160;</td><td class="mdescRight">Sets protein residue types from FASTA string.  <a href="#a9810f8767994c951a2faf44bb016eeea">More...</a><br /></td></tr>
<tr class="separator:a9810f8767994c951a2faf44bb016eeea"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af73b7c20000eb1eec867f8f17273aadd"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="Caterpillar_8c.html#af73b7c20000eb1eec867f8f17273aadd">CAT_insert_hydrogens</a> (<a class="el" href="structcat__prot.html">cat_prot</a> *protein)</td></tr>
<tr class="memdesc:af73b7c20000eb1eec867f8f17273aadd"><td class="mdescLeft">&#160;</td><td class="mdescRight">Adds hydrogens to an existing protein backbone.  <a href="#af73b7c20000eb1eec867f8f17273aadd">More...</a><br /></td></tr>
<tr class="separator:af73b7c20000eb1eec867f8f17273aadd"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:abe943fb25a4f091d183f647680c6ed76"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="Caterpillar_8c.html#abe943fb25a4f091d183f647680c6ed76">CAT_insert_cbeta</a> (<a class="el" href="structcat__prot.html">cat_prot</a> *protein, int res_i, double azimut, double bond_length)</td></tr>
<tr class="memdesc:abe943fb25a4f091d183f647680c6ed76"><td class="mdescLeft">&#160;</td><td class="mdescRight">Adds a CB atom to a given residue.  <a href="#abe943fb25a4f091d183f647680c6ed76">More...</a><br /></td></tr>
<tr class="separator:abe943fb25a4f091d183f647680c6ed76"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1af9e1eedb8da99e8536f8994464867b"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="Caterpillar_8c.html#a1af9e1eedb8da99e8536f8994464867b">CAT_rescale</a> (<a class="el" href="structcat__prot.html">cat_prot</a> *protein)</td></tr>
<tr class="memdesc:a1af9e1eedb8da99e8536f8994464867b"><td class="mdescLeft">&#160;</td><td class="mdescRight">Corrects numerical distortions in a <a class="el" href="structcat__prot.html" title="Main data structure for the caterpillar protein model. ">cat_prot</a> backbone.  <a href="#a1af9e1eedb8da99e8536f8994464867b">More...</a><br /></td></tr>
<tr class="separator:a1af9e1eedb8da99e8536f8994464867b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad0e418deb8a60c9c1a6ebdef6da7ed30"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="Caterpillar_8c.html#ad0e418deb8a60c9c1a6ebdef6da7ed30">CAT_add_peptide</a> (<a class="el" href="structcat__prot.html">cat_prot</a> *p, int I, double phi, double alpha, double psi)</td></tr>
<tr class="memdesc:ad0e418deb8a60c9c1a6ebdef6da7ed30"><td class="mdescLeft">&#160;</td><td class="mdescRight">Inserts peptide I based on the angles phi, psi, and alpha (link twist)  <a href="#ad0e418deb8a60c9c1a6ebdef6da7ed30">More...</a><br /></td></tr>
<tr class="separator:ad0e418deb8a60c9c1a6ebdef6da7ed30"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3e0dc3e15548b4e88cc5eb1f738bc7c7"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="Caterpillar_8c.html#a3e0dc3e15548b4e88cc5eb1f738bc7c7">CAT_prot_dihedrals</a> (<a class="el" href="structcat__prot.html">cat_prot</a> *protein)</td></tr>
<tr class="memdesc:a3e0dc3e15548b4e88cc5eb1f738bc7c7"><td class="mdescLeft">&#160;</td><td class="mdescRight">Computes all dihedral angles.  <a href="#a3e0dc3e15548b4e88cc5eb1f738bc7c7">More...</a><br /></td></tr>
<tr class="separator:a3e0dc3e15548b4e88cc5eb1f738bc7c7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a752507f90cf89d7caed22a2b7c10c332"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="Caterpillar_8c.html#a752507f90cf89d7caed22a2b7c10c332">compute_phi</a> (<a class="el" href="structcat__prot.html">cat_prot</a> *p, int c)</td></tr>
<tr class="memdesc:a752507f90cf89d7caed22a2b7c10c332"><td class="mdescLeft">&#160;</td><td class="mdescRight">Computes the phi dihedral of a given residue c.  <a href="#a752507f90cf89d7caed22a2b7c10c332">More...</a><br /></td></tr>
<tr class="separator:a752507f90cf89d7caed22a2b7c10c332"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a74ba17d45474e30c6d347c11c3dea3ce"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="Caterpillar_8c.html#a74ba17d45474e30c6d347c11c3dea3ce">compute_psi</a> (<a class="el" href="structcat__prot.html">cat_prot</a> *p, int c)</td></tr>
<tr class="memdesc:a74ba17d45474e30c6d347c11c3dea3ce"><td class="mdescLeft">&#160;</td><td class="mdescRight">Computes the psi dihedral of a given residue c.  <a href="#a74ba17d45474e30c6d347c11c3dea3ce">More...</a><br /></td></tr>
<tr class="separator:a74ba17d45474e30c6d347c11c3dea3ce"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad8433506298507c49ebe1caccff51fd5"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="Caterpillar_8c.html#ad8433506298507c49ebe1caccff51fd5">compute_dihedrals</a> (<a class="el" href="structcat__prot.html">cat_prot</a> *p)</td></tr>
<tr class="memdesc:ad8433506298507c49ebe1caccff51fd5"><td class="mdescLeft">&#160;</td><td class="mdescRight">Recomputes all dihedral angles.  <a href="#ad8433506298507c49ebe1caccff51fd5">More...</a><br /></td></tr>
<tr class="separator:ad8433506298507c49ebe1caccff51fd5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a975467da8688f9a04dc678114a4c5d0c"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="Caterpillar_8c.html#a975467da8688f9a04dc678114a4c5d0c">calc_dihedralf_angle</a> (double *atom_1, double *atom_2, double *atom_3, double *atom_4)</td></tr>
<tr class="memdesc:a975467da8688f9a04dc678114a4c5d0c"><td class="mdescLeft">&#160;</td><td class="mdescRight">Calculates the torsion angle between four successive atoms on a backbone.  <a href="#a975467da8688f9a04dc678114a4c5d0c">More...</a><br /></td></tr>
<tr class="separator:a975467da8688f9a04dc678114a4c5d0c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa1bbb30cdd8531c16216e4b119521637"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="Caterpillar_8c.html#aa1bbb30cdd8531c16216e4b119521637">build_peptide</a> (gsl_matrix *pep)</td></tr>
<tr class="memdesc:aa1bbb30cdd8531c16216e4b119521637"><td class="mdescLeft">&#160;</td><td class="mdescRight">Builds a caterpillar peptide in a local DH base.  <a href="#aa1bbb30cdd8531c16216e4b119521637">More...</a><br /></td></tr>
<tr class="separator:aa1bbb30cdd8531c16216e4b119521637"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>Interface for the Caterpillar protein model. Function's definitions. </p>
<dl class="todo"><dt><b><a class="el" href="todo.html#_todo000006">Todo:</a></b></dt><dd><p class="startdd">There are some large comented regions which might be good to remove if not relevant anymore. </p>
<p>Some functions might still need refinement ... regarding how they are written. </p>
<p>CAT_prot_dihedrals and compute_dihedrals does same thing ... I would leave only one ... </p>
<p class="enddd">... too many functions for dihedral calculation ... it would be best to have one that calcualte from 4 atoms then one that does from rezidue in protein and one that calculate for all residues </p>
</dd></dl>
<dl class="section note"><dt>Note</dt><dd>What about gly residue and CB atom ... how to treat that ... keep CB there but do not use it probbably ... </dd></dl>
</div><h2 class="groupheader">Function Documentation</h2>
<a class="anchor" id="aa1bbb30cdd8531c16216e4b119521637"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void build_peptide </td>
          <td>(</td>
          <td class="paramtype">gsl_matrix *&#160;</td>
          <td class="paramname"><em>pep</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Builds a caterpillar peptide in a local DH base. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in,out]</td><td class="paramname">*pep</td><td>coordinates of the atoms in the peptide</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd><code>void</code> </dd></dl>

</div>
</div>
<a class="anchor" id="a975467da8688f9a04dc678114a4c5d0c"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double calc_dihedralf_angle </td>
          <td>(</td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>atom_1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>atom_2</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>atom_3</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>atom_4</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Calculates the torsion angle between four successive atoms on a backbone. </p>
<p>This function was taken from LAMMPS.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">*atom_1</td><td>Coordinates of atom1 in 3D </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">*atom_2</td><td>Coordinates of atom2 in 3D </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">*atom_3</td><td>Coordinates of atom3 in 3D </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">*atom_4</td><td>Coordinates of atom4 in 3D</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>dihedral angle between atoms </dd></dl>

</div>
</div>
<a class="anchor" id="ad0e418deb8a60c9c1a6ebdef6da7ed30"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int CAT_add_peptide </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structcat__prot.html">cat_prot</a> *&#160;</td>
          <td class="paramname"><em>p</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>I</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>phi</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>alpha</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>psi</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Inserts peptide I based on the angles phi, psi, and alpha (link twist) </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in,out]</td><td class="paramname">*p</td><td><a class="el" href="structcat__prot.html" title="Main data structure for the caterpillar protein model. ">cat_prot</a> structure to be remodeled </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">I</td><td>Residue whose atom positions are recalculated </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">phi</td><td>PHI angle of given residue </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">alpha</td><td>DH link twist </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">psi</td><td>PSI angle of given residue</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>err code </dd></dl>

</div>
</div>
<a class="anchor" id="a92cf3cb6de5fafc75fa825ca64e1a571"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="structcat__prot.html">cat_prot</a>* CAT_build_from_dihed </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>n_res</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>n_atom_per_res</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>orig</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>dihed</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char *&#160;</td>
          <td class="paramname"><em>seq</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Constructs a protein configuration <a class="el" href="structcat__prot.html" title="Main data structure for the caterpillar protein model. ">cat_prot</a> from dihedral angles. </p>
<p>Builds a Caterpillar protein, assuming that the first dihedral angle passed through dihed is a phi angle.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">n_res</td><td>Number of residues in protein </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">n_atom_per_res</td><td>Number of atoms in one residue </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">*orig</td><td>Position of the first atom (Nitrogen) </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">*dihed</td><td>Array of protein dihedral angles, starting with phi </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">*seq</td><td>Protein sequence (FASTA 1-letter code)</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>builded <a class="el" href="structcat__prot.html" title="Main data structure for the caterpillar protein model. ">cat_prot</a> </dd></dl>

</div>
</div>
<a class="anchor" id="abe943fb25a4f091d183f647680c6ed76"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void CAT_insert_cbeta </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structcat__prot.html">cat_prot</a> *&#160;</td>
          <td class="paramname"><em>protein</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>res_i</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>azimut</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>bond_length</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Adds a CB atom to a given residue. </p>
<dl class="todo"><dt><b><a class="el" href="todo.html#_todo000008">Todo:</a></b></dt><dd>Check CaCb_versor calculation ... it seems that in the end it is kust -azimut*normal ... and mid part is unimportatnt? since CaCb_versor=-CaCb_versor-azimut*normal???</dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in,out]</td><td class="paramname">*protein</td><td>Protein in which CB are added </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">res_i</td><td>Residue to which the CB is added </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">azimut</td><td>Azimut angle of CB bond with respect to the C-CA-N plane </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">bond_length</td><td>Length of the CA-CB bond</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd><code>void</code> </dd></dl>

</div>
</div>
<a class="anchor" id="af73b7c20000eb1eec867f8f17273aadd"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void CAT_insert_hydrogens </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structcat__prot.html">cat_prot</a> *&#160;</td>
          <td class="paramname"><em>protein</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Adds hydrogens to an existing protein backbone. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in,out]</td><td class="paramname">*protein</td><td><a class="el" href="structcat__prot.html" title="Main data structure for the caterpillar protein model. ">cat_prot</a> structure to be remodeled</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd><code>void</code> </dd></dl>

</div>
</div>
<a class="anchor" id="acba34c254cdc4419a15eb3913ab88fcc"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void CAT_print </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structcat__prot.html">cat_prot</a> *&#160;</td>
          <td class="paramname"><em>protein</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Prints atom coordinates on stdout. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">*protein</td><td>Protein whose configuration is printed</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd><code>void</code> </dd></dl>

</div>
</div>
<a class="anchor" id="ae1b02845d422244db3c1cdfa38f3ee26"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="structcat__prot.html">cat_prot</a>* CAT_prot_alloc </td>
          <td>(</td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>n_res</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>n_atom_per_res</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Allocates and initializes a <a class="el" href="structcat__prot.html" title="Main data structure for the caterpillar protein model. ">cat_prot</a> structure. </p>
<p>All coordinates are set to 0.0, all dihedrals are set to 0.0. p-&gt;=n_res*n_atom_per_res, p-&gt;n_res=n_res, p-&gt;n_atom_per_res=n_atom_per_res, p-&gt;residues[i]=-1, p-&gt;contacts[i]=-1.0. </p><dl class="todo"><dt><b><a class="el" href="todo.html#_todo000007">Todo:</a></b></dt><dd>Atoms are aliased, we need to check optimization risks. </dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">n_res</td><td>Number of residues in peptide </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">n_atom_per_res</td><td>Number of atoms in each residue</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>initialized empty *cat_prot </dd></dl>

</div>
</div>
<a class="anchor" id="a3e0dc3e15548b4e88cc5eb1f738bc7c7"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void CAT_prot_dihedrals </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structcat__prot.html">cat_prot</a> *&#160;</td>
          <td class="paramname"><em>protein</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Computes all dihedral angles. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in,out]</td><td class="paramname">*p</td><td>Protein whose dihedrals are recalculated</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd><code>void</code> </dd></dl>

</div>
</div>
<a class="anchor" id="a2b2c2c60d002feceda7f4b52d9b1c075"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void CAT_prot_free </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structcat__prot.html">cat_prot</a> *&#160;</td>
          <td class="paramname"><em>p</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Deallocates a <a class="el" href="structcat__prot.html" title="Main data structure for the caterpillar protein model. ">cat_prot</a> structure. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in,out]</td><td class="paramname">*p</td><td><a class="el" href="structcat__prot.html" title="Main data structure for the caterpillar protein model. ">cat_prot</a> structure to dealloc</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd><code>void</code> </dd></dl>

</div>
</div>
<a class="anchor" id="a1af9e1eedb8da99e8536f8994464867b"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void CAT_rescale </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structcat__prot.html">cat_prot</a> *&#160;</td>
          <td class="paramname"><em>protein</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Corrects numerical distortions in a <a class="el" href="structcat__prot.html" title="Main data structure for the caterpillar protein model. ">cat_prot</a> backbone. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in,out]</td><td class="paramname">*protein</td><td><a class="el" href="structcat__prot.html" title="Main data structure for the caterpillar protein model. ">cat_prot</a> structure to be remodeled</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd><code>void</code> </dd></dl>

</div>
</div>
<a class="anchor" id="a51f603e9de1836964e2c5d042835b5a4"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void CAT_set_prot_linear </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structcat__prot.html">cat_prot</a> *&#160;</td>
          <td class="paramname"><em>protein</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>orig</em>[3], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>alpha</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in,out]</td><td class="paramname">*protein</td><td><a class="el" href="structcat__prot.html" title="Main data structure for the caterpillar protein model. ">cat_prot</a> structure to be remodeled </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">orig[3]</td><td>Starting poinf from where peptide chain is build </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">alpha</td><td>Deviation from the z axis</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd><code>void</code> </dd></dl>

</div>
</div>
<a class="anchor" id="a9810f8767994c951a2faf44bb016eeea"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void CAT_set_residues_fasta </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structcat__prot.html">cat_prot</a> *&#160;</td>
          <td class="paramname"><em>protein</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>Seq_Length</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char *&#160;</td>
          <td class="paramname"><em>Enc</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Sets protein residue types from FASTA string. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in,out]</td><td class="paramname">*protein</td><td>Protein modified to corespond to FASTA sequnce </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">Seq_Length</td><td>Number of residues in FASTA formatted string (*Enc) </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">*Enc</td><td>String of chars coresponding to FASTA code</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd><code>void</code> </dd></dl>

</div>
</div>
<a class="anchor" id="ad8433506298507c49ebe1caccff51fd5"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void compute_dihedrals </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structcat__prot.html">cat_prot</a> *&#160;</td>
          <td class="paramname"><em>p</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Recomputes all dihedral angles. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in,out]</td><td class="paramname">*p</td><td>Protein whose dihedrals are recalculated </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd><code>void</code> </dd></dl>

</div>
</div>
<a class="anchor" id="a752507f90cf89d7caed22a2b7c10c332"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double compute_phi </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structcat__prot.html">cat_prot</a> *&#160;</td>
          <td class="paramname"><em>p</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>c</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Computes the phi dihedral of a given residue c. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">*p</td><td>Protein </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">c</td><td>Index of the residue whose dihedral is calculated</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>phi dihedral angle </dd></dl>

</div>
</div>
<a class="anchor" id="a74ba17d45474e30c6d347c11c3dea3ce"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double compute_psi </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structcat__prot.html">cat_prot</a> *&#160;</td>
          <td class="paramname"><em>p</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>c</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Computes the psi dihedral of a given residue c. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">*p</td><td>Protein </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">c</td><td>Index of the residue whose dihedral is calculated</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>psi dihedral angle </dd></dl>

</div>
</div>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.11
</small></address>
</body>
</html>
